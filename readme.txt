Проактивная система оценки и краткосрочного прогнозирования пожарной опасности
на основе спутниковых данных и методов машинного обучения
(регион: Курганская область)

В рамках данного проекта разработана и реализована система оценки и краткосрочного прогнозирования пожарной опасности на региональном уровне. Проект ориентирован на анализ пространственно-временных закономерностей природных пожаров и направлен на формирование карт пожарного риска до фактического возникновения возгораний.

В качестве региона исследования выбрана Курганская область, характеризующаяся высокой пожароопасностью, разнообразием природных ландшафтов и наличием достаточного объёма исторических спутниковых данных. Проект выполнялся в рамках направления «Большие данные, искусственный интеллект, автоматизированные системы и безопасность» и соответствует требованиям научно-технологических конкурсов.

Целью проекта является построение воспроизводимой пространственно-временной модели, позволяющей оценивать вероятность возникновения пожара и ранжировать территорию по уровню пожарного риска. Проект не решает задачу детектирования уже произошедших пожаров и не подменяет системы оперативного мониторинга, а ориентирован именно на прогноз и оценку риска на коротком горизонте времени.

Постановка задачи основана на строгой причинно-следственной логике. Прогноз выполняется по схеме «признаки в день D → вероятность пожара в день D+1», что исключает использование будущей информации и обеспечивает корректность временной валидации. Базовой единицей анализа является сочетание идентификатора пространственной ячейки и даты наблюдения. Территория региона разбита на регулярную геопространственную сетку, каждая ячейка которой рассматривается как минимальная единица прогнозирования.

В проекте используются спутниковые данные дистанционного зондирования Земли и метеорологическая информация. Для описания состояния растительного покрова применяются данные MODIS MOD13Q1, на основе которых рассчитывается индекс NDVI, используемый как прокси-показатель биомассы и влажности топлива. Исторические факты пожаров формируются на основе данных VIIRS Active Fire (NASA FIRMS) и используются для построения целевой переменной. Дополнительно интегрируются метеорологические данные ERA5-Land, включающие температуру, осадки и скорость ветра, агрегированные на ежедневной основе. Пространственный контекст дополняется данными о дорожной сети и населённых пунктах.

Проект реализован в виде воспроизводимого data science / machine learning pipeline с чётким разделением этапов обработки данных. Исходные данные хранятся без изменений, после чего выполняется пространственная и временная агрегация, формирование регулярных сеток и сопоставление разнородных источников. На следующем этапе реализуется feature engineering, включающий расчёт интерпретируемых признаков, отражающих физическую природу процесса. Итоговым результатом является формирование обучающего ML-датасета, обучение моделей, оценка качества и визуализация результатов.

Особое внимание в проекте уделено feature engineering. Для NDVI реализованы временные лаги, скользящие статистики, дельты изменений и сезонные аномалии. Все временные признаки рассчитываются по фактическому времени наблюдений, а не по порядку строк, что особенно важно при работе с нерегулярными спутниковыми временными рядами. Расчёты выполняются без утечек информации и с учётом ограничений по памяти. Для метеорологических данных используется отдельная погодная сетка с более крупным пространственным разрешением, что соответствует масштабу атмосферных процессов. Для погодных параметров также рассчитываются лаги и агрегаты, причём используются только значения, доступные до момента прогнозирования.

В качестве основной модели машинного обучения используется логистическая регрессия. Выбор данной модели обусловлен её интерпретируемостью, устойчивостью при сильном дисбалансе классов и пригодностью для задач ранжирования риска. В рамках обучения применяется стандартизация признаков, обработка пропусков и балансировка классов. В качестве экспериментального подхода тестировалась модель XGBoost, однако без добавления новых факторов она продемонстрировала переобучение и худшее обобщающее качество, что было честно зафиксировано и использовано для обоснования выбора baseline-модели.

Оценка качества моделей проводится с использованием метрик, корректных для задач с редкими событиями. Основными метриками являются ROC-AUC и PR-AUC. Дополнительно реализована пространственно-агрегированная проверка, оценивающая, в какой степени реальные пожары концентрируются в зонах с наибольшим прогнозируемым риском. Метрика accuracy намеренно не используется, так как она неинформативна при экстремальном дисбалансе классов.

Результаты работы модели визуализируются в виде карт пожарного риска. Карты строятся на конкретную дату и используют только данные, доступные до момента прогнозирования. Для визуализации применяются форматы GeoJSON и интерактивные HTML-карты, что позволяет анализировать результаты как в ГИС-средах, так и в веб-интерфейсе. Карты отражают относительный уровень риска и предназначены для аналитической оценки пространственного распределения пожарной опасности.

В работе осознанно зафиксированы ограничения проекта. NDVI отражает фоновую пожарную опасность, но не является достаточным условием возгорания. Пространственная локализация очагов пожаров ограничена доступными данными, а антропогенные факторы учитываются лишь косвенно. Эти ограничения не скрываются и рассматриваются как обоснование для дальнейшего развития проекта, в частности за счёт расширения набора факторов.

В текущем виде проект полностью реализован, воспроизводим и готов к использованию в качестве исследовательской системы. Полученные результаты демонстрируют возможность применения спутниковых данных и методов машинного обучения для оценки пожарного риска и анализа пространственно-временной структуры пожароопасных территорий.

fire_forecast_kurgan
├── checkset.ipynb
├── ndvi_full_features.parquet
├── readme.txt
├── tree.py
├── notebooks
│   ├── 01_data_check.ipynb
│   ├── 02_label_y.ipynb
│   ├── 03_temporal_label_y_t_plus_1.ipynb
│   ├── 04_ndvi_local.ipynb
│   ├── 05_ndvi_modis_all_years.ipynb
│   ├── 06_fires_viirs_to_grid.ipynb
│   ├── 06_ndvi_fire_alignment.ipynb
│   ├── Untitled.ipynb
├── src
│   ├── datasets
│   │   ├── build_fire_dataset.py
│   │   ├── build_ml_dataset.py
│   │   ├── build_ml_dataset_with_weather.py
│   │   ├── label_ndvi.py
│   ├── features
│   │   ├── infrastructure.py
│   │   ├── weather.py
│   │   ├── ndvi
│   │   │   ├── anomaly.py
│   │   │   ├── delta.py
│   │   │   ├── lags.py
│   │   │   ├── rolling.py
│   ├── models
│   │   ├── 04_plot_feature_importance.py
│   │   ├── compare_models.py
│   │   ├── interpret_logreg.py
│   │   ├── train_logreg.py
│   │   ├── train_xgboost.py
│   │   ├── train_xgboost2.py
│   ├── preprocessing
│   │   ├── grid.py
│   │   ├── spatial_join.py
│   │   ├── weather_aggregation.py
│   │   ├── weather_grid.py
│   │   ├── weather_sanity_check.py
│   │   ├── fires
│   │   │   ├── daily_labels.py
│   │   │   ├── fires_to_grid.py
│   │   │   ├── load_viirs.py
│   │   ├── ndvi
│   │   │   ├── ndvi_to_grid.py
│   │   │   ├── read_hdf.py
│   ├── risk
│   │   ├── fireriskandscore.py
│   │   ├── fire_risk.py
│   │   ├── priority_score.py
│   ├── visualization
│   │   ├── aggregate_validation.py
│   │   ├── build_risk_map.py
│   │   ├── check_coverage.py
│   │   ├── compare_with_fires.py
│   │   ├── list_fire_dates.py
│   │   ├── predict_risk_map.py